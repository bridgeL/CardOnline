### 服务器端运行架构

#### 游戏大厅模式

- 通讯模块 - 开启连接 - 单独开启一个线程负责监听新的连接请求，并将他们加入到设备列表里，并分配设备号
- 循环等待消息 - 游戏大厅模块 - 捕获到消息后，经过分类器函数辨识，交由不同的函数处理
  - 捕获到注册请求 - 处理注册昵称函数
  - 捕获到座位请求 - 处理座位函数
  - 捕获到开始游戏请求 - 处理游戏开始函数
    - 如果成功，则结束本模式下的所有的临时变量、线程，跳出循环，进入下一个模式

#### 游戏模式

- 循环等待消息
  - 接收到表情消息 - 丢给表情模块
  - 接收到卡牌消息 - 丢给卡牌模块 - 丢给分类器
    - 接收到犯人出逃成功、侦探指认成功等处理结果后，跳出循环，进入下一个模式

#### 游戏结束模式

- 游戏大厅模块 - 处理游戏结算函数


## 服务器端

服务器端应准备的模块

### 通讯模块 √

实现对客户端和服务端连接的封装

#### 消息缓存队列 √
#### 设备列表 √
#### 连接函数 √
#### 底层发送函数（阻塞式）√
#### 底层接收函数（阻塞式）√
#### 高层次发送函数（阻塞式） √
#### 高层次接收函数（非阻塞式，多线程，持续监听） √

### 游戏大厅模块

实现了登入昵称的注册，以及座位的分配

#### 昵称列表
#### 座位列表
#### 阵营列表
#### 当前玩家的设备号
#### 分类器
#### 处理注册昵称函数
#### 处理座位函数
#### 处理游戏开始函数
#### 处理游戏结算函数

### 表情模块

服务器端无需存储任何表情文件，表情文件存储在客户端本体

服务器端只负责通知客户端展示表情，并对频繁发送表情的行为作出限制

#### 处理表情函数

### 卡牌模块

服务器端无需存储任何卡牌文件，卡牌文件存储在客户端本体

服务器端只负责通知客户端展示卡牌的转移情况，并对特殊卡牌实现其效果

#### 分类器函数
#### 处理普通人/不在场证明/第一发现人函数
#### 处理共犯函数
#### 处理交易函数
#### 处理谣言函数
#### 处理情报交换函数
#### 处理目击者函数
#### 处理犯人函数
#### 处理侦探函数
#### 处理神犬函数


